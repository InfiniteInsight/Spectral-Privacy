# =============================================================================
# SonarQube Configuration for Spectral
# =============================================================================
# Run: sonar-scanner (requires sonar-scanner CLI installed)
# Or via Docker:
#   docker run --rm \
#     -e SONAR_HOST_URL="http://192.168.1.220:9000" \
#     -e SONAR_TOKEN="sqa_f66361d94bd050f9b4a1e8f847ede991098dbea" \
#     -v "$(pwd):/usr/src" \
#     sonarsource/sonar-scanner-cli
# =============================================================================

# Project identification
sonar.projectKey=spectral
sonar.projectName=Spectral
sonar.projectVersion=0.1.0

# Server configuration
sonar.host.url=http://192.168.1.220:9000

# Authentication (prefer environment variable SONAR_TOKEN for CI)
# sonar.token is set via environment variable or command line

# =============================================================================
# Source configuration
# =============================================================================

# Rust sources (core logic)
sonar.sources=src-tauri/src,crates,src

# Test sources
sonar.tests=src-tauri/src,crates
sonar.test.inclusions=**/*_test.rs,**/tests/**/*.rs,**/*.test.ts,**/*.spec.ts

# Exclusions
sonar.exclusions=\
  **/node_modules/**,\
  **/target/**,\
  **/dist/**,\
  **/build/**,\
  **/.svelte-kit/**,\
  **/coverage/**,\
  **/*.min.js,\
  **/vendor/**

# =============================================================================
# Language-specific settings
# =============================================================================

# Rust analysis (via community plugin or SonarQube's Rust support)
sonar.rust.clippy.reportPaths=clippy-report.json

# TypeScript/JavaScript
sonar.typescript.tsconfigPath=tsconfig.json
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# =============================================================================
# Code coverage
# =============================================================================

# Rust coverage (via cargo-tarpaulin or llvm-cov)
sonar.rust.coverage.reportPaths=coverage/rust/cobertura.xml

# Frontend coverage
sonar.coverage.jacoco.xmlReportPaths=coverage/lcov.info

# =============================================================================
# Quality gates and analysis
# =============================================================================

# Encoding
sonar.sourceEncoding=UTF-8

# SCM
sonar.scm.provider=git

# Duplicate detection
sonar.cpd.exclusions=**/tests/**,**/*_test.rs

# Issue severity
sonar.issue.ignore.multicriteria=e1,e2

# Ignore test files for certain rules
sonar.issue.ignore.multicriteria.e1.ruleKey=rust:S1481
sonar.issue.ignore.multicriteria.e1.resourceKey=**/tests/**

# Ignore test utilities
sonar.issue.ignore.multicriteria.e2.ruleKey=typescript:S1481
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.test.ts
